<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vertex</title>
    <link rel="icon" type="image/png" href="assets/favicon.png">
    <style>
        body { background-color: #0a0a0a; color: #f5f5f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; font-family: 'Inter', sans-serif; text-align: center; }
        .container { display: flex; flex-direction: column; align-items: center; gap: 1rem;}
        h1 { font-size: 2rem; font-weight: 600; letter-spacing: -0.5px; }
        .spinner { width: 32px; height: 32px; border: 3px solid #333; border-top-color: #fff; border-radius: 50%; animation: spin 0.8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="container">
        <h1>Vertex</h1>
        <div class="spinner"></div>
    </div>

    <script>
        (async function autoRedirect() {
            // If the user has visited before, send them to their last selected language or default to English.
            // This prevents them from being stuck on this loading page if they navigate back to the root.
            if (localStorage.getItem('hasVisited')) {
                const lang = localStorage.getItem('selectedLanguage') || 'en';
                const basePath = window.location.pathname.includes('/vertexite-main/') ? '/vertexite-main' : '';
                window.location.replace(`${window.location.origin}${basePath}/${lang}/`);
                return;
            }

            let detectedLang = 'en'; // Default language for international users

            try {
                // Fetch country code from a fast, permission-less IP geolocation API
                const response = await fetch('https://ipapi.co/country_code/');
                if (response.ok) {
                    const countryCode = await response.text();
                    console.log('üåç IP-based country detected:', countryCode);
                    if (countryCode === 'TR') {
                        detectedLang = 'tr';
                    } else if (countryCode === 'IN') {
                        detectedLang = 'hi';
                    }
                }
            } catch (error) {
                console.warn('IP geolocation failed. Falling back to browser language.', error);
                // Fallback to browser language if IP detection fails
                const browserLang = (navigator.language || navigator.userLanguage).substring(0, 2);
                if (browserLang === 'tr') {
                    detectedLang = 'tr';
                } else if (browserLang === 'hi') {
                    detectedLang = 'hi';
                }
            }
            
            console.log('üöÄ Redirecting to language:', detectedLang);

            // Mark as visited to prevent redirect loops and respect user's future language choices
            localStorage.setItem('hasVisited', 'true');
            localStorage.setItem('selectedLanguage', detectedLang);
            
            const basePath = window.location.protocol === 'file:' 
                ? window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/')).replace(/\/[^/]+\.html$/, '') 
                : (window.location.pathname.includes('/vertexite-main/') ? '/vertexite-main' : '');
            const redirectUrl = `${window.location.origin}${basePath}/${detectedLang}/`;
            
            // Use replace to avoid adding the root page to the session history
            window.location.replace(redirectUrl);
        })();
    </script>
</body>
</html>
